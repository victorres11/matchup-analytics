<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FIU Panthers - Snap Count Analytics</title>
    <link rel="icon" type="image/svg+xml" href="./Big_Ten_Conference_logo.svg">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 50%, #fbbf24 100%);
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(30,58,138,0.3);
            color: white;
        }

        .logos {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .logo {
            height: 60px;
            width: auto;
        }

        .logo.conference-usa {
            height: 180px;
            width: auto;
        }

        .divider {
            width: 2px;
            height: 40px;
            background: #fbbf24;
        }

        h1 {
            color: white;
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            color: #fbbf24;
            font-size: 1.1rem;
            margin-bottom: 20px;
            font-weight: 500;
        }

        .timestamp {
            color: #e5e7eb;
            font-size: 0.9rem;
            font-style: italic;
        }

        .stats-summary {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(30,58,138,0.3);
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-card {
            text-align: center;
            padding: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            border: 1px solid rgba(251,191,36,0.3);
            backdrop-filter: blur(10px);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #fbbf24;
            margin-bottom: 5px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        .stat-label {
            color: #1a1a1a;
            font-size: 0.9rem;
            font-weight: 500;
            background: rgba(255,255,255,0.9);
            padding: 4px 8px;
            border-radius: 4px;
            display: inline-block;
        }

        .tabs {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(30,58,138,0.2);
        }

        .tab-buttons {
            display: flex;
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            border-bottom: 1px solid #fbbf24;
        }

        .tab-btn {
            flex: 1;
            padding: 20px;
            background: none;
            border: none;
            font-size: 1.1rem;
            font-weight: 600;
            color: #e5e7eb;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .tab-btn:hover {
            background: rgba(251,191,36,0.2);
            color: #fbbf24;
        }

        .tab-btn.active {
            background: #fbbf24;
            color: #1e3a8a;
            font-weight: 700;
        }

        .tab-content {
            display: none;
            padding: 30px;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .position-group {
            margin-bottom: 40px;
        }

        .position-group-row {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
        }

        .position-group.half-width {
            flex: 1;
            margin-bottom: 0;
        }

        @media (max-width: 768px) {
            .position-group-row {
                flex-direction: column;
                gap: 20px;
            }
            
            .position-group.half-width {
                margin-bottom: 40px;
            }
        }

        .position-title {
            color: #1e3a8a;
            font-size: 1.5rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #fbbf24;
            font-weight: 600;
        }

        .chart-container {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid #fbbf24;
            box-shadow: 0 4px 15px rgba(30,58,138,0.1);
        }

        .chart-wrapper {
            position: relative;
            height: 300px;
            margin-bottom: 20px;
        }

        .chart-canvas {
            width: 100% !important;
            height: 100% !important;
        }

        .player-details {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: none;
        }

        .player-details.active {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .player-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .player-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .player-card:hover {
            background: #e9ecef;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .player-name {
            font-weight: 600;
            color: #1a1a1a;
            margin-bottom: 5px;
        }

        .player-info {
            color: #6b7280;
            font-size: 0.9rem;
        }

        .player-stats {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #e5e7eb;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #6b7280;
            font-size: 0.8rem;
        }

        .stat-value {
            color: #1a1a1a;
            font-weight: 600;
            font-size: 0.8rem;
        }

        .footer {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            padding: 40px 20px;
            margin-top: 50px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(30,58,138,0.3);
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }

        .footer-section h3 {
            color: #fbbf24;
            font-size: 1.2rem;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .footer-section p {
            color: #e5e7eb;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .footer-section a {
            color: #fbbf24;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-section a:hover {
            color: white;
        }

        .footer-bottom {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(251,191,36,0.3);
            color: #fbbf24;
            font-style: italic;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .tab-btn {
                padding: 15px;
                font-size: 1rem;
            }
            
            .tab-content {
                padding: 20px;
            }
            
            .stats-summary {
                grid-template-columns: 1fr;
            }

            .footer {
                padding: 30px 15px;
            }

            .footer-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logos">
                <img src="./fiu_logo_main.svg" alt="FIU Panthers" class="logo">
                <div class="divider"></div>
                <img src="./conference_usa_2023-pres.webp" alt="Conference USA" class="logo conference-usa">
            </div>
            <h1>FIU Panthers</h1>
            <p class="subtitle">Snap Count Analytics Dashboard</p>
            <p class="timestamp" id="last-updated">Updated at <span id="update-time"></span></p>
        </div>

        <div class="stats-summary">
            <div class="stat-card">
                <div class="stat-number" id="total-offense">-</div>
                <div class="stat-label">Total Offensive Snaps</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="total-defense">-</div>
                <div class="stat-label">Total Defensive Snaps</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="avg-offense">-</div>
                <div class="stat-label">Avg Offensive Snaps</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="avg-defense">-</div>
                <div class="stat-label">Avg Defensive Snaps</div>
            </div>
        </div>

        <div class="tabs">
            <div class="tab-buttons">
                <button class="tab-btn active" onclick="showTab('offense')">OFFENSIVE</button>
                <button class="tab-btn" onclick="showTab('defense')">DEFENSIVE</button>
            </div>

            <!-- Offensive Tab -->
            <div id="offense" class="tab-content active">
                <div class="position-group">
                    <h3 class="position-title">Wide Receivers</h3>
                    <div class="chart-container">
                        <div class="chart-wrapper">
                            <canvas id="wr-chart" class="chart-canvas"></canvas>
                        </div>
                        <div class="player-details" id="wr-details"></div>
                    </div>
                </div>

                <div class="position-group-row">
                    <div class="position-group half-width">
                        <h3 class="position-title">Tight Ends</h3>
                        <div class="chart-container">
                            <div class="chart-wrapper">
                                <canvas id="te-chart" class="chart-canvas"></canvas>
                            </div>
                            <div class="player-details" id="te-details"></div>
                        </div>
                    </div>

                    <div class="position-group half-width">
                        <h3 class="position-title">Running Backs</h3>
                        <div class="chart-container">
                            <div class="chart-wrapper">
                                <canvas id="rb-chart" class="chart-canvas"></canvas>
                            </div>
                            <div class="player-details" id="rb-details"></div>
                        </div>
                    </div>
                </div>

                <div class="position-group">
                    <h3 class="position-title">Offensive Line</h3>
                    <div class="chart-container">
                        <div class="chart-wrapper">
                            <canvas id="ol-chart" class="chart-canvas"></canvas>
                        </div>
                        <div class="player-details" id="ol-details"></div>
                    </div>
                </div>
            </div>

            <!-- Defensive Tab -->
            <div id="defense" class="tab-content">
                <div class="position-group">
                    <h3 class="position-title">Defensive Backs</h3>
                    <div class="chart-container">
                        <div class="chart-wrapper">
                            <canvas id="db-chart" class="chart-canvas"></canvas>
                        </div>
                        <div class="player-details" id="db-details"></div>
                    </div>
                </div>

                <div class="position-group">
                    <h3 class="position-title">Linebackers</h3>
                    <div class="chart-container">
                        <div class="chart-wrapper">
                            <canvas id="lb-chart" class="chart-canvas"></canvas>
                        </div>
                        <div class="player-details" id="lb-details"></div>
                    </div>
                </div>

                <div class="position-group">
                    <h3 class="position-title">Defensive Line</h3>
                    <div class="chart-container">
                        <div class="chart-wrapper">
                            <canvas id="dl-chart" class="chart-canvas"></canvas>
                        </div>
                        <div class="player-details" id="dl-details"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>📊 Data Sources</h3>
                    <p>Snap count data is sourced from PFF Data, providing comprehensive player participation analytics and game film analysis. All player participation data reflects actual game time and is updated following each contest.</p>
                    <p>Data accuracy is maintained through PFF's comprehensive review of official game records and statistical databases.</p>
                </div>
                
                <div class="footer-section">
                    <h3>🏈 Analytics</h3>
                    <p>This dashboard provides comprehensive snap count analysis for college football teams, breaking down player participation by position groups and game situations.</p>
                    <p>Charts powered by Chart.js for professional-grade data visualization and interactive analytics.</p>
                </div>
                
                <div class="footer-section">
                    <h3>⚡ Technology</h3>
                    <p>Built with modern web technologies including HTML5, CSS3, JavaScript, and Chart.js for responsive, professional analytics dashboards.</p>
                    <p>Deployed on GitHub Pages for reliable, fast-loading performance worldwide.</p>
                </div>
            </div>
            
            <div class="footer-bottom">
                Made with love from Richmond, VA by Vic Torres
            </div>
        </div>
    </div>

    <script>
        // Tab switching functionality
        function showTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));
            
            // Remove active class from all tab buttons
            const tabButtons = document.querySelectorAll('.tab-btn');
            tabButtons.forEach(btn => btn.classList.remove('active'));
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');
        }

        // Chart.js configuration with FIU colors
        const chartConfig = {
            type: 'bar',
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        backgroundColor: 'rgba(26, 26, 26, 0.9)',
                        titleColor: 'white',
                        bodyColor: 'white',
                        borderColor: '#1a1a1a',
                        borderWidth: 1,
                        cornerRadius: 8,
                        displayColors: false,
                        callbacks: {
                            label: function(context) {
                                // Determine if this is offensive or defensive chart based on context
                                let totalSnaps;
                                const chartId = context.chart.canvas.id;
                                if (chartId.includes('wr') || chartId.includes('te') || chartId.includes('rb') || chartId.includes('ol')) {
                                    totalSnaps = 76; // FIU Offensive Total
                                } else {
                                    totalSnaps = 70; // FIU Defensive Total
                                }
                                
                                // Get player position from stored player data
                                const player = context.dataset.players[context.dataIndex];
                                const playerPosition = player ? ` • ${player.position}` : '';
                                
                                const percentage = ((context.parsed.y / totalSnaps) * 100).toFixed(1);
                                return `Snaps: ${context.parsed.y} (${percentage}%)${playerPosition}`;
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: 'rgba(0, 0, 0, 0.1)',
                            drawBorder: false
                        },
                        ticks: {
                            color: '#6b7280',
                            font: {
                                size: 12
                            }
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        },
                        ticks: {
                            color: '#6b7280',
                            font: {
                                size: 11
                            },
                            maxRotation: 45,
                            minRotation: 0
                        }
                    }
                },
                interaction: {
                    intersect: false,
                    mode: 'index'
                }
            }
        };

        // Load and display data
        async function loadData() {
            try {
                const [offenseData, defenseData] = await Promise.all([
                    fetch('./fiu_offense_data.json').then(res => res.json()),
                    fetch('./fiu_defense_data.json').then(res => res.json())
                ]);

                displayOffensiveData(offenseData.offense);
                displayDefensiveData(defenseData.defense);
                updateStats(offenseData.offense, defenseData.defense);
            } catch (error) {
                console.error('Error loading data:', error);
            }
        }

        function displayOffensiveData(data) {
            createChart('wr-chart', data.wide_receivers, 'wr-details');
            createChart('te-chart', data.tight_ends, 'te-details');
            createChart('rb-chart', data.running_backs, 'rb-details');
            createChart('ol-chart', data.offensive_line, 'ol-details');
        }

        function displayDefensiveData(data) {
            createChart('db-chart', data.defensive_backs, 'db-details');
            createChart('lb-chart', data.linebackers, 'lb-details');
            createChart('dl-chart', data.defensive_line, 'dl-details');
        }

        function createChart(canvasId, players, detailsId) {
            if (!players || players.length === 0) return;

            const canvas = document.getElementById(canvasId);
            const details = document.getElementById(detailsId);
            
            // Clear existing content
            details.innerHTML = '';

            // Sort players by snaps (descending)
            const sortedPlayers = [...players].sort((a, b) => b.snaps - a.snaps);
            
            // Use correct team totals for percentage calculation
            let totalSnaps;
            if (canvasId.includes('wr') || canvasId.includes('te') || canvasId.includes('rb') || canvasId.includes('ol')) {
                totalSnaps = 76; // FIU Offensive Total
            } else {
                totalSnaps = 70; // FIU Defensive Total
            }
            
            // Prepare data for Chart.js
            const labels = sortedPlayers.map(player => {
                const nameParts = player.name.split(' ');
                let lastName = nameParts[nameParts.length - 1];
                
                // Handle "Jr." names properly
                if (lastName === 'Jr.' && nameParts.length > 1) {
                    lastName = nameParts[nameParts.length - 2] + ' Jr.';
                }
                // Handle "JR" names properly (without period)
                else if (lastName === 'JR' && nameParts.length > 1) {
                    lastName = nameParts[nameParts.length - 2] + ' JR';
                }
                // Handle "II" names properly
                else if (lastName === 'II' && nameParts.length > 1) {
                    lastName = nameParts[nameParts.length - 2] + ' II';
                }
                
                const percentage = ((player.snaps / totalSnaps) * 100).toFixed(1);
                return `${lastName} #${player.jersey} (${percentage}%)`;
            });
            
            const data = sortedPlayers.map(player => player.snaps);
            
            // Create Chart.js chart with FIU colors
            new Chart(canvas, {
                ...chartConfig,
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: 'rgba(30, 58, 138, 0.8)',
                        borderColor: 'rgba(30, 58, 138, 1)',
                        borderWidth: 1,
                        borderRadius: 4,
                        hoverBackgroundColor: 'rgba(251, 191, 36, 0.9)',
                        hoverBorderColor: 'rgba(251, 191, 36, 1)',
                        players: sortedPlayers // Store player data for tooltip access
                    }]
                }
            });

            // Create player details section
            createPlayerDetailsSection(sortedPlayers, details);
        }

        function createPlayerDetailsSection(players, detailsElement) {
            if (!players || players.length === 0) return;

            const grid = document.createElement('div');
            grid.className = 'player-grid';

            players.forEach(player => {
                const card = document.createElement('div');
                card.className = 'player-card';
                card.onclick = () => showPlayerDetails(player, detailsElement);

                card.innerHTML = `
                    <div class="player-name">${player.name}</div>
                    <div class="player-info">#${player.jersey} • ${player.position}</div>
                    <div class="player-stats">
                        <div class="stat-row">
                            <span class="stat-label">Snaps:</span>
                            <span class="stat-value">${player.snaps}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Snap %:</span>
                            <span class="stat-value">${player.snap_percentage}%</span>
                        </div>
                    </div>
                `;

                grid.appendChild(card);
            });

            detailsElement.appendChild(grid);
        }

        function showPlayerDetails(player, detailsElement) {
            // Toggle details visibility
            if (detailsElement.classList.contains('active')) {
                detailsElement.classList.remove('active');
            } else {
                detailsElement.classList.add('active');
            }
        }

        function updateStats(offenseData, defenseData) {
            // Use actual team totals
            const offensiveSnaps = 76; // FIU Offensive Snap Total
            const defensiveSnaps = 70; // FIU Defensive Snap Total
            
            // Calculate averages based on actual totals
            const offensivePlayers = Object.values(offenseData).flat().length;
            const defensivePlayers = Object.values(defenseData).flat().length;
            const offensiveAvg = Math.round(offensiveSnaps / offensivePlayers);
            const defensiveAvg = Math.round(defensiveSnaps / defensivePlayers);

            // Update display
            document.getElementById('total-offense').textContent = offensiveSnaps;
            document.getElementById('total-defense').textContent = defensiveSnaps;
            document.getElementById('avg-offense').textContent = offensiveAvg;
            document.getElementById('avg-defense').textContent = defensiveAvg;
        }

        function updateTimestamp() {
            const now = new Date();
            const timeString = now.toLocaleString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            document.getElementById('update-time').textContent = timeString;
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            updateTimestamp();
            loadData();
        });
    </script>
</body>
</html>
